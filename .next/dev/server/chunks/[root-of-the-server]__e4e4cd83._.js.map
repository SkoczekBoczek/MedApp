{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/nikodemwitkowski/Desktop/WEBSITE/MedApp/app/api/events/route.js"],"sourcesContent":["import { MongoClient } from \"mongodb\";\n\nlet cachedClient = null;\nlet cachedDb = null;\n\nasync function connectToDatabase() {\n\tif (cachedClient && cachedDb) return { client: cachedClient, db: cachedDb };\n\n\tconst client = await MongoClient.connect(process.env.MONGODB_URI);\n\tconst db = client.db(\"clinicDB\");\n\n\tcachedClient = client;\n\tcachedDb = db;\n\n\treturn { client, db };\n}\n\nexport async function GET(req) {\n\ttry {\n\t\tconst { db } = await connectToDatabase();\n\n\t\tconst { searchParams } = new URL(req.url);\n\n\t\tconst userToken = searchParams.get(\"token\");\n\t\tconst events = await db.collection(\"events\").find({ userToken }).toArray();\n\n\t\treturn new Response(JSON.stringify(events), {\n\t\t\tstatus: 200,\n\t\t\theaders: { \"Content-Type\": \"application/json\" },\n\t\t});\n\t} catch (error) {\n\t\treturn new Response(JSON.stringify({ error: \"Internal Server Error\" }), {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"Content-Type\": \"application/json\" },\n\t\t});\n\t}\n}\n\nexport async function POST(req) {\n\ttry {\n\t\tconst { db } = await connectToDatabase();\n\t\tconst newEvent = await req.json();\n\n\t\tif (!newEvent) {\n\t\t\treturn new Response(JSON.stringify({ error: \"Missing data\" }), {\n\t\t\t\tstatus: 400,\n\t\t\t\theaders: { \"Content-Type\": \"application/json\" },\n\t\t\t});\n\t\t}\n\n\t\tawait db.collection(\"events\").insertOne(newEvent);\n\n\t\treturn new Response(\n\t\t\tJSON.stringify({ message: \"Event added successfully\" }),\n\t\t\t{\n\t\t\t\tstatus: 200,\n\t\t\t\theaders: { \"Content-Type\": \"application/json\" },\n\t\t\t}\n\t\t);\n\t} catch (error) {\n\t\treturn new Response(JSON.stringify({ error: \"Internal Server Error\" }), {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"Content-Type\": \"application/json\" },\n\t\t});\n\t}\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,IAAI,eAAe;AACnB,IAAI,WAAW;AAEf,eAAe;IACd,IAAI,gBAAgB,UAAU,OAAO;QAAE,QAAQ;QAAc,IAAI;IAAS;IAE1E,MAAM,SAAS,MAAM,sHAAW,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,WAAW;IAChE,MAAM,KAAK,OAAO,EAAE,CAAC;IAErB,eAAe;IACf,WAAW;IAEX,OAAO;QAAE;QAAQ;IAAG;AACrB;AAEO,eAAe,IAAI,GAAG;IAC5B,IAAI;QACH,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;QAErB,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;QAExC,MAAM,YAAY,aAAa,GAAG,CAAC;QACnC,MAAM,SAAS,MAAM,GAAG,UAAU,CAAC,UAAU,IAAI,CAAC;YAAE;QAAU,GAAG,OAAO;QAExE,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC,SAAS;YAC3C,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;QAC/C;IACD,EAAE,OAAO,OAAO;QACf,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE,OAAO;QAAwB,IAAI;YACvE,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;QAC/C;IACD;AACD;AAEO,eAAe,KAAK,GAAG;IAC7B,IAAI;QACH,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;QACrB,MAAM,WAAW,MAAM,IAAI,IAAI;QAE/B,IAAI,CAAC,UAAU;YACd,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;gBAAE,OAAO;YAAe,IAAI;gBAC9D,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;YAC/C;QACD;QAEA,MAAM,GAAG,UAAU,CAAC,UAAU,SAAS,CAAC;QAExC,OAAO,IAAI,SACV,KAAK,SAAS,CAAC;YAAE,SAAS;QAA2B,IACrD;YACC,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;QAC/C;IAEF,EAAE,OAAO,OAAO;QACf,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE,OAAO;QAAwB,IAAI;YACvE,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;QAC/C;IACD;AACD","debugId":null}}]
}